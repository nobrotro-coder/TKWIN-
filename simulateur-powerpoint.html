<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulateur Microsoft PowerPoint - TKWIN+</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Source+Sans+Pro:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        .text-body {
            font-family: 'Source Sans Pro', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        .ppt-ribbon {
            background: linear-gradient(to bottom, #f3f3f3 0%, #e9e9e9 100%);
            border-bottom: 1px solid #d4d4d4;
        }
        .ribbon-tab {
            padding: 8px 16px;
            border: 1px solid transparent;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .ribbon-tab:hover {
            background: rgba(255, 255, 255, 0.7);
            border-color: #d4d4d4;
        }
        .ribbon-tab.active {
            background: white;
            border-color: #d4d4d4;
            border-bottom-color: white;
            margin-bottom: -1px;
        }
        .ribbon-button {
            padding: 6px 12px;
            border: 1px solid transparent;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 60px;
        }
        .ribbon-button:hover {
            background: rgba(249, 115, 22, 0.1);
            border-color: #f97316;
        }
        .ribbon-button.active {
            background: rgba(249, 115, 22, 0.2);
            border-color: #f97316;
        }
        .presentation-area {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        .slides-panel {
            width: 200px;
            background: #f8fafc;
            border: 1px solid #d4d4d4;
            border-radius: 8px;
            padding: 16px;
            max-height: 600px;
            overflow-y: auto;
        }
        .slide-thumbnail {
            width: 100%;
            height: 120px;
            background: white;
            border: 2px solid #d4d4d4;
            border-radius: 8px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 12px;
            color: #6b7280;
        }
        .slide-thumbnail:hover {
            border-color: #f97316;
            transform: translateY(-2px);
        }
        .slide-thumbnail.active {
            border-color: #f97316;
            background: #fff7ed;
        }
        .slide-canvas {
            flex: 1;
            background: white;
            border: 1px solid #d4d4d4;
            border-radius: 8px;
            min-height: 500px;
            position: relative;
            overflow: hidden;
        }
        .slide-content {
            width: 100%;
            height: 100%;
            padding: 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        .sidebar-item {
            transition: all 0.2s ease;
        }
        .sidebar-item:hover {
            background-color: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
        }
        .sidebar-item.active {
            background-color: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        .exercise-panel {
            background: #f8fafc;
            border-left: 4px solid #f97316;
        }
        .design-panel {
            background: white;
            border: 1px solid #d4d4d4;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }
        .theme-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 12px;
        }
        .theme-option {
            width: 60px;
            height: 40px;
            border: 2px solid #d4d4d4;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .theme-option:hover {
            border-color: #f97316;
            transform: scale(1.05);
        }
        .theme-option.active {
            border-color: #f97316;
            border-width: 3px;
        }
        .animation-controls {
            background: #f9fafb;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
        }
        .slide-number {
            position: absolute;
            bottom: 10px;
            right: 10px;
            font-size: 12px;
            color: #6b7280;
        }
        .text-element {
            position: absolute;
            cursor: move;
            user-select: none;
            border: 2px dashed transparent;
            padding: 4px;
            transition: border-color 0.2s;
        }
        .text-element:hover {
            border-color: #f97316;
        }
        .text-element.selected {
            border-color: #f97316;
            border-style: solid;
        }
        .shape-element {
            position: absolute;
            cursor: move;
            user-select: none;
            border: 2px dashed transparent;
            transition: border-color 0.2s;
        }
        .shape-element:hover {
            border-color: #f97316;
        }
        .shape-element.selected {
            border-color: #f97316;
            border-style: solid;
        }
        .image-element {
            position: absolute;
            cursor: move;
            user-select: none;
            border: 2px dashed transparent;
            transition: border-color 0.2s;
        }
        .image-element:hover {
            border-color: #f97316;
        }
        .image-element.selected {
            border-color: #f97316;
            border-style: solid;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-900">
    <!-- Header -->
    <header class="bg-white shadow-sm fixed w-full top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <img src="resources/tkwin-logo.png" alt="TKWIN+" class="h-8 w-8 mr-3">
                    <span class="text-xl font-bold text-blue-600">TKWIN+</span>
                    <span class="ml-4 text-gray-600">Simulateur Microsoft PowerPoint</span>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="startPresentation()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                        Lancer la présentation
                    </button>
                    <button onclick="insertSlide()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                        Nouvelle diapositive
                    </button>
                    <button onclick="window.location.href='dashboard.html'" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                        Retour au tableau de bord
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="flex pt-16">
        <!-- Sidebar -->
        <aside class="w-64 bg-white shadow-lg fixed left-0 top-16 bottom-0 z-30 overflow-y-auto">
            <nav class="p-4 space-y-2">
                <div class="sidebar-item p-3 cursor-pointer" onclick="window.location.href='dashboard.html'">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-gray-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z" />
                        </svg>
                        <span class="font-medium text-gray-700">Tableau de bord</span>
                    </div>
                </div>
                
                <div class="sidebar-item p-3 cursor-pointer" onclick="window.location.href='simulateur-word.html'">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-blue-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        <span class="font-medium text-gray-700">Word</span>
                    </div>
                </div>

                <div class="sidebar-item p-3 cursor-pointer" onclick="window.location.href='simulateur-excel.html'">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        <span class="font-medium text-gray-700">Excel</span>
                    </div>
                </div>

                <div class="sidebar-item active p-3 cursor-pointer">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-orange-600 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2h4a1 1 0 110 2h-1v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6H3a1 1 0 110-2h4z" />
                        </svg>
                        <span class="font-medium text-gray-900">PowerPoint</span>
                    </div>
                </div>
            </nav>

            <!-- Design Panel -->
            <div class="p-4">
                <div class="design-panel">
                    <h4 class="font-semibold text-gray-900 mb-3">Conception</h4>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Thèmes</label>
                        <div class="theme-selector">
                            <div class="theme-option active" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" onclick="applyTheme('professional')" title="Professionnel"></div>
                            <div class="theme-option" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);" onclick="applyTheme('creative')" title="Créatif"></div>
                            <div class="theme-option" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);" onclick="applyTheme('modern')" title="Moderne"></div>
                            <div class="theme-option" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);" onclick="applyTheme('nature')" title="Nature"></div>
                            <div class="theme-option" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);" onclick="applyTheme('energetic')" title="Énergique"></div>
                            <div class="theme-option" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);" onclick="applyTheme('minimal')" title="Minimaliste"></div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Couleur principale</label>
                        <input type="color" value="#667eea" class="w-full h-10 rounded border border-gray-300" onchange="updatePrimaryColor(this.value)">
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Police</label>
                        <select class="w-full p-2 border border-gray-300 rounded" onchange="updateFontFamily(this.value)">
                            <option value="Inter">Inter</option>
                            <option value="Source Sans Pro">Source Sans Pro</option>
                            <option value="Arial">Arial</option>
                            <option value="Times New Roman">Times New Roman</option>
                            <option value="Helvetica">Helvetica</option>
                        </select>
                    </div>
                </div>

                <div class="animation-controls">
                    <h4 class="font-semibold text-gray-900 mb-3">Animations</h4>
                    <div class="space-y-2">
                        <button onclick="addAnimation('fadeIn')" class="w-full text-left p-2 text-sm hover:bg-gray-200 rounded">
                            Apparition
                        </button>
                        <button onclick="addAnimation('slideIn')" class="w-full text-left p-2 text-sm hover:bg-gray-200 rounded">
                            Glissement
                        </button>
                        <button onclick="addAnimation('zoomIn')" class="w-full text-left p-2 text-sm hover:bg-gray-200 rounded">
                            Zoom
                        </button>
                        <button onclick="addAnimation('bounce')" class="w-full text-left p-2 text-sm hover:bg-gray-200 rounded">
                            Rebond
                        </button>
                    </div>
                </div>
            </div>

            <!-- Exercise Panel -->
            <div class="exercise-panel p-4 m-4 rounded-lg">
                <h4 class="font-semibold text-gray-900 mb-3">Exercice: Présentation d'entreprise</h4>
                <div class="space-y-3 text-sm">
                    <div>
                        <strong>Objectif:</strong> Créer une présentation professionnelle avec 5 diapositives
                    </div>
                    <div class="space-y-2">
                        <div class="flex items-center">
                            <input type="checkbox" checked disabled class="mr-2">
                            <span class="text-green-600">Diapositive titre créée</span>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-2" id="content-slide-check">
                            <span class="text-gray-600">Diapositive de contenu</span>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-2" id="chart-slide-check">
                            <span class="text-gray-600">Diapositive avec graphique</span>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-2" id="animation-check">
                            <span class="text-gray-600">Animations ajoutées</span>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-2" id="transition-check">
                            <span class="text-gray-600">Transitions configurées</span>
                        </div>
                    </div>
                    <div class="pt-2">
                        <div class="text-xs text-gray-600 mb-1">Progression</div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-orange-600 h-2 rounded-full" style="width: 20%" id="exercise-progress"></div>
                        </div>
                        <div class="text-xs text-gray-600 mt-1">20% complété</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 ml-64 p-6">
            <!-- Ribbon Interface -->
            <div class="ppt-ribbon rounded-lg mb-6">
                <!-- Tabs -->
                <div class="flex border-b border-gray-300 px-4 pt-2">
                    <div class="ribbon-tab active" data-tab="home">
                        <span class="font-medium">Accueil</span>
                    </div>
                    <div class="ribbon-tab" data-tab="insert">
                        <span class="font-medium">Insertion</span>
                    </div>
                    <div class="ribbon-tab" data-tab="design">
                        <span class="font-medium">Conception</span>
                    </div>
                    <div class="ribbon-tab" data-tab="transitions">
                        <span class="font-medium">Transitions</span>
                    </div>
                    <div class="ribbon-tab" data-tab="animations">
                        <span class="font-medium">Animations</span>
                    </div>
                    <div class="ribbon-tab" data-tab="slideShow">
                        <span class="font-medium">Diaporama</span>
                    </div>
                </div>

                <!-- Home Tab Content -->
                <div id="home-tab" class="ribbon-content p-4">
                    <div class="flex items-center space-x-6">
                        <!-- Clipboard Group -->
                        <div class="flex items-center space-x-2 border-r border-gray-300 pr-4">
                            <div class="ribbon-button" data-tooltip="Nouvelle diapositive" onclick="insertSlide()">
                                <svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                </svg>
                                <span class="text-xs">Nouveau</span>
                            </div>
                            <div class="ribbon-button" data-tooltip="Dupliquer" onclick="duplicateSlide()">
                                <svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                </svg>
                                <span class="text-xs">Dupliquer</span>
                            </div>
                            <div class="ribbon-button" data-tooltip="Supprimer" onclick="deleteSlide()">
                                <svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                </svg>
                                <span class="text-xs">Supprimer</span>
                            </div>
                        </div>

                        <!-- Font Group -->
                        <div class="flex items-center space-x-2 border-r border-gray-300 pr-4">
                            <select class="px-3 py-1 border border-gray-300 rounded text-sm" id="fontFamily" onchange="updateFont()">
                                <option value="Inter">Inter</option>
                                <option value="Arial">Arial</option>
                                <option value="Times New Roman">Times New Roman</option>
                                <option value="Helvetica">Helvetica</option>
                            </select>
                            <select class="px-3 py-1 border border-gray-300 rounded text-sm" id="fontSize" onchange="updateSize()">
                                <option value="14">14</option>
                                <option value="16">16</option>
                                <option value="18" selected>18</option>
                                <option value="20">20</option>
                                <option value="24">24</option>
                                <option value="32">32</option>
                                <option value="48">48</option>
                            </select>
                        </div>

                        <!-- Paragraph Group -->
                        <div class="flex items-center space-x-2 border-r border-gray-300 pr-4">
                            <div class="ribbon-button" data-tooltip="Aligner à gauche" onclick="alignText('left')">
                                <svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h10M4 14h16M4 18h10" />
                                </svg>
                                <span class="text-xs">Gauche</span>
                            </div>
                            <div class="ribbon-button" data-tooltip="Centrer" onclick="alignText('center')">
                                <svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M8 10h8M4 14h16M8 18h8" />
                                </svg>
                                <span class="text-xs">Centrer</span>
                            </div>
                            <div class="ribbon-button" data-tooltip="Aligner à droite" onclick="alignText('right')">
                                <svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M14 10h6M4 14h16M14 18h6" />
                                </svg>
                                <span class="text-xs">Droite</span>
                            </div>
                        </div>

                        <!-- Drawing Group -->
                        <div class="flex items-center space-x-2">
                            <div class="ribbon-button" data-tooltip="Texte" onclick="addTextElement()">
                                <svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                </svg>
                                <span class="text-xs">Texte</span>
                            </div>
                            <div class="ribbon-button" data-tooltip="Forme" onclick="addShape()">
                                <svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                                <span class="text-xs">Forme</span>
                            </div>
                            <div class="ribbon-button" data-tooltip="Image" onclick="addImage()">
                                <svg class="w-5 h-5 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                                <span class="text-xs">Image</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Presentation Area -->
            <div class="presentation-area">
                <!-- Slides Panel -->
                <div class="slides-panel">
                    <h3 class="font-semibold text-gray-900 mb-4">Diapositives</h3>
                    <div id="slidesList">
                        <div class="slide-thumbnail active" data-slide="0" onclick="selectSlide(0)">
                            <div class="text-center">
                                <div class="text-lg font-bold mb-2">Titre</div>
                                <div class="text-xs">Diapositive de titre</div>
                            </div>
                        </div>
                        <div class="slide-thumbnail" data-slide="1" onclick="selectSlide(1)">
                            <div class="text-center">
                                <div class="text-sm font-bold mb-1">Contenu</div>
                                <div class="text-xs">Diapositive de contenu</div>
                            </div>
                        </div>
                        <div class="slide-thumbnail" data-slide="2" onclick="selectSlide(2)">
                            <div class="text-center">
                                <div class="text-sm font-bold mb-1">Graphique</div>
                                <div class="text-xs">Diapositive avec graphique</div>
                            </div>
                        </div>
                        <div class="slide-thumbnail" data-slide="3" onclick="selectSlide(3)">
                            <div class="text-center">
                                <div class="text-sm font-bold mb-1">Conclusion</div>
                                <div class="text-xs">Diapositive finale</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide Canvas -->
                <div class="slide-canvas">
                    <div class="slide-content" id="slideContent">
                        <div class="text-element" style="top: 50px; left: 50px; font-size: 48px; font-weight: bold; color: #1f2937;">
                            TKWIN+ Présentation
                        </div>
                        <div class="text-element" style="top: 150px; left: 50px; font-size: 24px; color: #6b7280;">
                            Plateforme Éducative Numérique
                        </div>
                        <div class="text-element" style="top: 400px; left: 50px; font-size: 18px; color: #374151;">
                            Transformez votre apprentissage avec nos outils innovants
                        </div>
                        <div class="shape-element" style="top: 300px; left: 200px; width: 100px; height: 100px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%;"></div>
                    </div>
                    <div class="slide-number">1 / 4</div>
                </div>
            </div>
        </main>
    </div>

    <script>
        let currentSlide = 0;
        let selectedElement = null;
        let isDragging = false;
        let dragOffset = { x: 0, y: 0 };

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            initializePresentation();
            
            // Animation d'apparition
            anime({
                targets: '.presentation-area',
                opacity: [0, 1],
                translateY: [20, 0],
                duration: 800,
                easing: 'easeOutQuart'
            });
        });

        function initializePresentation() {
            // Gestion des onglets
            const tabs = document.querySelectorAll('.ribbon-tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // Gestion des éléments de la diapositive
            const slideContent = document.getElementById('slideContent');
            slideContent.addEventListener('click', handleSlideClick);
            slideContent.addEventListener('mousedown', startDrag);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', endDrag);
        }

        function selectSlide(index) {
            currentSlide = index;
            
            // Mettre à jour les miniatures
            const thumbnails = document.querySelectorAll('.slide-thumbnail');
            thumbnails.forEach((thumb, i) => {
                thumb.classList.toggle('active', i === index);
            });

            // Mettre à jour le contenu de la diapositive
            updateSlideContent();
            
            // Mettre à jour le numéro de diapositive
            const slideNumber = document.querySelector('.slide-number');
            slideNumber.textContent = `${index + 1} / ${thumbnails.length}`;
        }

        function updateSlideContent() {
            const slideContent = document.getElementById('slideContent');
            const contents = [
                // Slide 1: Titre
                `
                <div class="text-element" style="top: 50px; left: 50px; font-size: 48px; font-weight: bold; color: #1f2937;">
                    TKWIN+ Présentation
                </div>
                <div class="text-element" style="top: 150px; left: 50px; font-size: 24px; color: #6b7280;">
                    Plateforme Éducative Numérique
                </div>
                <div class="text-element" style="top: 400px; left: 50px; font-size: 18px; color: #374151;">
                    Transformez votre apprentissage avec nos outils innovants
                </div>
                <div class="shape-element" style="top: 300px; left: 200px; width: 100px; height: 100px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%;"></div>
                `,
                // Slide 2: Contenu
                `
                <div class="text-element" style="top: 30px; left: 50px; font-size: 36px; font-weight: bold; color: #1f2937;">
                    Nos Services
                </div>
                <div class="text-element" style="top: 120px; left: 50px; font-size: 20px; color: #374151;">
                    ✓ Cours interactifs en ligne
                </div>
                <div class="text-element" style="top: 170px; left: 50px; font-size: 20px; color: #374151;">
                    ✓ Simulateurs bureautiques
                </div>
                <div class="text-element" style="top: 220px; left: 50px; font-size: 20px; color: #374151;">
                    ✓ Support personnalisé
                </div>
                <div class="text-element" style="top: 270px; left: 50px; font-size: 20px; color: #374151;">
                    ✓ Certification reconnue
                </div>
                <div class="shape-element" style="top: 350px; left: 50px; width: 400px; height: 4px; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);"></div>
                `,
                // Slide 3: Graphique
                `
                <div class="text-element" style="top: 30px; left: 50px; font-size: 36px; font-weight: bold; color: #1f2937;">
                    Performance de la plateforme
                </div>
                <div class="text-element" style="top: 100px; left: 50px; font-size: 18px; color: #374151;">
                    • 95% de taux de réussite
                </div>
                <div class="text-element" style="top: 140px; left: 50px; font-size: 18px; color: #374151;">
                    • +10,000 étudiants formés
                </div>
                <div class="text-element" style="top: 180px; left: 50px; font-size: 18px; color: #374151;">
                    • 24/7 support technique
                </div>
                <div class="text-element" style="top: 220px; left: 50px; font-size: 18px; color: #374151;">
                    • Formateurs certifiés
                </div>
                <div class="shape-element" style="top: 300px; left: 300px; width: 200px; height: 150px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px;"></div>
                <div class="text-element" style="top: 350px; left: 350px; font-size: 24px; color: white; font-weight: bold;">
                    95%
                </div>
                <div class="text-element" style="top: 380px; left: 320px; font-size: 14px; color: white;">
                    Taux de réussite
                </div>
                `,
                // Slide 4: Conclusion
                `
                <div class="text-element" style="top: 50px; left: 50px; font-size: 48px; font-weight: bold; color: #1f2937;">
                    Prêt à commencer ?
                </div>
                <div class="text-element" style="top: 150px; left: 50px; font-size: 24px; color: #374151;">
                    Rejoignez la communauté TKWIN+ dès aujourd'hui
                </div>
                <div class="text-element" style="top: 250px; left: 50px; font-size: 18px; color: #6b7280;">
                    • Inscription gratuite
                </div>
                <div class="text-element" style="top: 290px; left: 50px; font-size: 18px; color: #6b7280;">
                    • Accès immédiat aux cours
                </div>
                <div class="text-element" style="top: 330px; left: 50px; font-size: 18px; color: #6b7280;">
                    • Support personnalisé
                </div>
                <div class="shape-element" style="top: 400px; left: 200px; width: 200px; height: 50px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 25px;"></div>
                <div class="text-element" style="top: 415px; left: 280px; font-size: 18px; color: white; font-weight: bold;">
                    Commencer
                </div>
                `
            ];

            slideContent.innerHTML = contents[index];
            
            // Réinitialiser la sélection d'élément
            selectedElement = null;
        }

        function insertSlide() {
            const slidesList = document.getElementById('slidesList');
            const slideCount = slidesList.children.length;
            
            const newSlide = document.createElement('div');
            newSlide.className = 'slide-thumbnail';
            newSlide.setAttribute('data-slide', slideCount);
            newSlide.onclick = () => selectSlide(slideCount);
            newSlide.innerHTML = `
                <div class="text-center">
                    <div class="text-sm font-bold mb-1">Nouvelle</div>
                    <div class="text-xs">Diapositive ${slideCount + 1}</div>
                </div>
            `;
            
            slidesList.appendChild(newSlide);
            selectSlide(slideCount);
            updateExerciseProgress();
        }

        function duplicateSlide() {
            if (currentSlide >= 0) {
                insertSlide();
                // Copier le contenu de la diapositive actuelle
                const currentContent = document.getElementById('slideContent').innerHTML;
                const slideContent = document.getElementById('slideContent');
                updateSlideContent(); // Recharger le contenu par défaut
            }
        }

        function deleteSlide() {
            const thumbnails = document.querySelectorAll('.slide-thumbnail');
            if (thumbnails.length > 1) {
                thumbnails[currentSlide].remove();
                
                // Réorganiser les indices
                thumbnails.forEach((thumb, index) => {
                    if (index > currentSlide) {
                        thumb.setAttribute('data-slide', index - 1);
                        thumb.onclick = () => selectSlide(index - 1);
                    }
                });
                
                // Sélectionner la diapositive précédente ou la première
                const newIndex = Math.max(0, currentSlide - 1);
                selectSlide(newIndex);
                updateExerciseProgress();
            }
        }

        function startPresentation() {
            // Mode présentation (simulation)
            const slideContent = document.getElementById('slideContent');
            slideContent.style.background = 'black';
            slideContent.style.color = 'white';
            slideContent.style.padding = '80px';
            
            // Cacher les éléments de contrôle
            document.querySelector('.ppt-ribbon').style.display = 'none';
            document.querySelector('.slides-panel').style.display = 'none';
            
            showSuccess('Mode présentation activé ! Appuyez sur Échap pour quitter.');
            
            // Sortie du mode présentation avec Échap
            document.addEventListener('keydown', function exitPresentation(e) {
                if (e.key === 'Escape') {
                    document.querySelector('.ppt-ribbon').style.display = 'block';
                    document.querySelector('.slides-panel').style.display = 'block';
                    slideContent.style.background = 'white';
                    slideContent.style.color = 'black';
                    slideContent.style.padding = '40px';
                    document.removeEventListener('keydown', exitPresentation);
                }
            });
        }

        function addTextElement() {
            const slideContent = document.getElementById('slideContent');
            const textElement = document.createElement('div');
            textElement.className = 'text-element';
            textElement.style.top = '200px';
            textElement.style.left = '200px';
            textElement.style.fontSize = '24px';
            textElement.style.color = '#374151';
            textElement.textContent = 'Nouveau texte';
            textElement.contentEditable = 'true';
            
            slideContent.appendChild(textElement);
            updateExerciseProgress();
        }

        function addShape() {
            const slideContent = document.getElementById('slideContent');
            const shapeElement = document.createElement('div');
            shapeElement.className = 'shape-element';
            shapeElement.style.top = '300px';
            shapeElement.style.left = '300px';
            shapeElement.style.width = '100px';
            shapeElement.style.height = '100px';
            shapeElement.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            shapeElement.style.borderRadius = '8px';
            
            slideContent.appendChild(shapeElement);
            updateExerciseProgress();
        }

        function addImage() {
            const imageUrl = prompt('Entrez l\'URL de l\'image:');
            if (imageUrl) {
                const slideContent = document.getElementById('slideContent');
                const imageElement = document.createElement('img');
                imageElement.className = 'image-element';
                imageElement.src = imageUrl;
                imageElement.style.top = '250px';
                imageElement.style.left = '250px';
                imageElement.style.width = '200px';
                imageElement.style.height = '150px';
                imageElement.style.objectFit = 'cover';
                imageElement.style.borderRadius = '8px';
                
                slideContent.appendChild(imageElement);
                updateExerciseProgress();
            }
        }

        function applyTheme(theme) {
            const themes = {
                professional: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                creative: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                modern: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
                nature: 'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
                energetic: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
                minimal: 'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)'
            };
            
            const slideContent = document.getElementById('slideContent');
            slideContent.style.background = themes[theme];
            
            // Mettre à jour les formes
            const shapes = document.querySelectorAll('.shape-element');
            shapes.forEach(shape => {
                shape.style.background = themes[theme];
            });
            
            // Mettre à jour les boutons de thème
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function updateFont() {
            const font = document.getElementById('fontFamily').value;
            const textElements = document.querySelectorAll('.text-element');
            textElements.forEach(element => {
                element.style.fontFamily = font;
            });
        }

        function updateSize() {
            const size = document.getElementById('fontSize').value;
            const textElements = document.querySelectorAll('.text-element');
            textElements.forEach(element => {
                element.style.fontSize = size + 'px';
            });
        }

        function alignText(alignment) {
            const slideContent = document.getElementById('slideContent');
            slideContent.style.textAlign = alignment;
        }

        function addAnimation(type) {
            if (selectedElement) {
                selectedElement.style.animation = `${type} 1s ease-in-out`;
                showSuccess(`Animation ${type} ajoutée !`);
                updateExerciseProgress();
            }
        }

        function handleSlideClick(e) {
            // Retirer la sélection précédente
            if (selectedElement) {
                selectedElement.classList.remove('selected');
            }
            
            // Sélectionner le nouvel élément
            if (e.target.classList.contains('text-element') || 
                e.target.classList.contains('shape-element') || 
                e.target.classList.contains('image-element')) {
                selectedElement = e.target;
                selectedElement.classList.add('selected');
            } else {
                selectedElement = null;
            }
        }

        function startDrag(e) {
            if (selectedElement && (e.target.classList.contains('text-element') || 
                                   e.target.classList.contains('shape-element') || 
                                   e.target.classList.contains('image-element'))) {
                isDragging = true;
                const rect = selectedElement.getBoundingClientRect();
                dragOffset.x = e.clientX - rect.left;
                dragOffset.y = e.clientY - rect.top;
                selectedElement.style.cursor = 'grabbing';
            }
        }

        function drag(e) {
            if (isDragging && selectedElement) {
                const slideContent = document.getElementById('slideContent');
                const slideRect = slideContent.getBoundingClientRect();
                
                const x = e.clientX - slideRect.left - dragOffset.x;
                const y = e.clientY - slideRect.top - dragOffset.y;
                
                selectedElement.style.left = Math.max(0, Math.min(x, slideRect.width - selectedElement.offsetWidth)) + 'px';
                selectedElement.style.top = Math.max(0, Math.min(y, slideRect.height - selectedElement.offsetHeight)) + 'px';
            }
        }

        function endDrag() {
            if (isDragging && selectedElement) {
                isDragging = false;
                selectedElement.style.cursor = 'move';
            }
        }

        function updateExerciseProgress() {
            const progressBar = document.getElementById('exercise-progress');
            const contentSlideCheck = document.getElementById('content-slide-check');
            const chartSlideCheck = document.getElementById('chart-slide-check');
            const animationCheck = document.getElementById('animation-check');
            const transitionCheck = document.getElementById('transition-check');
            
            let progress = 20; // Diapositive titre par défaut
            
            // Vérifier si diapositive de contenu
            const textElements = document.querySelectorAll('.text-element');
            if (textElements.length > 3) {
                progress += 20;
                contentSlideCheck.checked = true;
            }
            
            // Vérifier si diapositive avec graphique/forme
            const shapeElements = document.querySelectorAll('.shape-element');
            if (shapeElements.length > 1) {
                progress += 20;
                chartSlideCheck.checked = true;
            }
            
            // Vérifier les animations
            const animatedElements = document.querySelectorAll('[style*="animation"]');
            if (animatedElements.length > 0) {
                progress += 20;
                animationCheck.checked = true;
            }
            
            // Vérifier les transitions (simulé)
            if (progress >= 80) {
                progress += 20;
                transitionCheck.checked = true;
            }
            
            progressBar.style.width = progress + '%';
            progressBar.parentNode.querySelector('.text-xs').textContent = progress + '% complété';
            
            if (progress >= 100) {
                showSuccess('Félicitations ! Vous avez terminé l\'exercice PowerPoint.');
            }
        }

        function showSuccess(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            successDiv.textContent = message;
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.remove();
            }, 5000);
        }

        // CSS pour les animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            @keyframes slideIn {
                from { transform: translateX(-100%); }
                to { transform: translateX(0); }
            }
            @keyframes zoomIn {
                from { transform: scale(0); }
                to { transform: scale(1); }
            }
            @keyframes bounce {
                0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
                40% { transform: translateY(-30px); }
                60% { transform: translateY(-15px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>